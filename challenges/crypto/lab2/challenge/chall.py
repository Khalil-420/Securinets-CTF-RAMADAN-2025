from secrets import a, b, flag
import hashlib
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad

p = 118055586074173742169392398151732870983872346647799647555329744489280354915466785767073419158698779556801850507261209366710644954719853958289620165514482154777048663342785076832394465405197446193164652130109247053792218040585885840088128136178244097614469436254266888367118250033401659771517809324380513327787

g = 82112030198947055840071277347981948716575861977494959133951905346648940846987967047593803014665244680742840842532651544795119107041654291873498624585621410004499194806553820537813193645293820009740753969157973882440485012280322172807652114765168686933550783421087074534524544829031200240598641285394497

A = pow(g, a, p)
B = pow(g, b, p)

S = pow(A, b, p)

key = hashlib.sha256(str(S).encode()).digest() 
cipher = AES.new(key, AES.MODE_ECB) 
encrypted_data = cipher.encrypt(pad(flag.encode(), AES.block_size)) 

out = "A = {0} \nB = {1} \nP = {2} \nCipherText = {3} \n".format(A,B,p,encrypted_data.hex())
open('output.txt','w').write(out)
from secrets import a, b, flag
import hashlib
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad

p = 118055586074173742169392398151732870983872346647799647555329744489280354915466785767073419158698779556801850507261209366710644954719853958289620165514482154777048663342785076832394465405197446193164652130109247053792218040585885840088128136178244097614469436254266888367118250033401659771517809324380513327787

g = 92712569051118324624163777030225679880037816225838666082834205892711517607871367519373116045681234172310131283980970162764730670800612148042154480854859805814600779558709299214977431849279998233735999476679855755122710649567328152058538503060065277476459150466171277436945226393670324128859337742967835348592
A = pow(g, a, p)
B = pow(g, b, p)

S = pow(A, b, p)

key = hashlib.sha256(str(S).encode()).digest() 
cipher = AES.new(key, AES.MODE_ECB) 
encrypted_data = cipher.encrypt(pad(flag.encode(), AES.block_size)) 

out = "A = {0} \nB = {1} \nP = {2} \nCipherText = {3} \n".format(A,B,p,encrypted_data.hex())
open('output.txt','w').write(out)
